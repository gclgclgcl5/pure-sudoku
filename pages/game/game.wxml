<!-- æ¸¸æˆé¡µé¢ - é˜¶æ®µ6ç‰ˆæœ¬ -->
<view class="container" style="background: linear-gradient(180deg, {{theme.colors.background}} 0%, {{theme.colors.background}} 100%);">
  <view class="content">
    <!-- é¡¶éƒ¨ä¿¡æ¯æ  - 3ä¸ªå…ƒç´ ï¼Œå„å 1/3 -->
    <view class="info-bar" style="background: linear-gradient(135deg, {{theme.colors.primary}}, {{theme.colors.primaryDark}});">
      <!-- éš¾åº¦æ˜¾ç¤ºï¼ˆåªè¯»ï¼Œæ¨ªå‘å¸ƒå±€ï¼‰ -->
      <view class="info-item difficulty-item">
        <text class="info-label">éš¾åº¦ï¼š</text>
        <text class="info-value">{{difficulties[difficultyIndex].label}}</text>
      </view>
      
      <!-- é”™è¯¯è®¡æ•° -->
      <view class="info-item error-item">
        <text class="info-label">é”™è¯¯ï¼š</text>
        <text class="error-count">{{errorCount}}/3</text>
      </view>
      
      <!-- è®¡æ—¶å™¨ -->
      <view class="info-item timer-item">
        <text class="info-label">ç”¨æ—¶ï¼š</text>
        <text class="timer-text">{{currentTime}}</text>
      </view>
    </view>
    
    <!-- æœ€ä½³æ—¶é—´ -->
    <view class="best-time" wx:if="{{bestTime}}" style="background: {{theme.colors.sameNumber}};">
      <text class="best-time-label" style="color: {{theme.colors.textMedium}};">ğŸ† æœ€ä½³:</text>
      <text class="best-time-value" style="color: {{theme.colors.textDark}};">{{bestTime}}</text>
    </view>
    
    <!-- æ•°ç‹¬æ£‹ç›˜ -->
    <view class="board {{isPaused ? 'paused' : ''}}">
      <block wx:for="{{cells}}" wx:key="index">
        <view 
          class="cell {{item.isFixed ? 'fixed' : ''}} {{item.index === selectedIndex ? 'selected' : ''}} {{item.isRelated ? 'related' : ''}} {{item.isSameNumber ? 'same-number' : ''}} {{item.hasError ? 'error' : ''}} {{item.showHint ? 'hint-active' : ''}} {{item.isRightBorder ? 'border-right' : ''}} {{item.isBottomBorder ? 'border-bottom' : ''}}"
          style="{{item.index === selectedIndex ? 'background-color: ' + theme.colors.selected + ' !important;' : item.isRelated ? 'background-color: ' + theme.colors.related + ';' : item.isSameNumber ? 'background-color: ' + theme.colors.sameNumber + ';' : item.isFixed ? 'background-color: ' + theme.colors.fixed + ';' : ''}}{{item.hasError ? ' background-color: ' + theme.colors.errorBg + ' !important;' : ''}}{{item.showHint ? ' background: linear-gradient(135deg, ' + theme.colors.hint + ', ' + theme.colors.success + ') !important;' : ''}}"
          data-index="{{item.index}}"
          bindtap="onCellTap">
          <!-- æ­£å¸¸æ•°å­— (æš‚åœæ—¶éšè—) -->
          <text class="cell-text" wx:if="{{item.value && !item.showHint && !isPaused}}" style="color: {{item.index === selectedIndex ? theme.colors.selectedText : item.isFixed ? theme.colors.textDark : theme.colors.textDark}};">{{item.value}}</text>
          
          <!-- æç¤ºæ•°å­—ï¼ˆå¸¦åŠ¨ç”»ï¼Œæš‚åœæ—¶éšè—ï¼‰ -->
          <text class="hint-text" wx:if="{{item.showHint && !isPaused}}">{{item.hintValue}}</text>
          
          <!-- ç¬”è®°æ¨¡å¼ï¼šå€™é€‰æ•°å­—ï¼ˆ3Ã—3ç½‘æ ¼ï¼Œå›ºå®šä½ç½®ï¼‰ -->
          <view class="notes-grid" wx:if="{{!item.value && !item.showHint && !isPaused && item.noteFlags}}">
            <text class="note-cell {{item.noteFlags.n1 ? 'show' : 'hide'}}" style="color: {{theme.colors.note}};">1</text>
            <text class="note-cell {{item.noteFlags.n2 ? 'show' : 'hide'}}" style="color: {{theme.colors.note}};">2</text>
            <text class="note-cell {{item.noteFlags.n3 ? 'show' : 'hide'}}" style="color: {{theme.colors.note}};">3</text>
            <text class="note-cell {{item.noteFlags.n4 ? 'show' : 'hide'}}" style="color: {{theme.colors.note}};">4</text>
            <text class="note-cell {{item.noteFlags.n5 ? 'show' : 'hide'}}" style="color: {{theme.colors.note}};">5</text>
            <text class="note-cell {{item.noteFlags.n6 ? 'show' : 'hide'}}" style="color: {{theme.colors.note}};">6</text>
            <text class="note-cell {{item.noteFlags.n7 ? 'show' : 'hide'}}" style="color: {{theme.colors.note}};">7</text>
            <text class="note-cell {{item.noteFlags.n8 ? 'show' : 'hide'}}" style="color: {{theme.colors.note}};">8</text>
            <text class="note-cell {{item.noteFlags.n9 ? 'show' : 'hide'}}" style="color: {{theme.colors.note}};">9</text>
          </view>
        </view>
      </block>
      
      <!-- æš‚åœé®ç½© -->
      <view class="pause-overlay" wx:if="{{isPaused}}">
        <view class="pause-content">
          <text class="pause-icon">â¸</text>
          <text class="pause-text">æ¸¸æˆå·²æš‚åœ</text>
          <text class="pause-hint">ç‚¹å‡»"ç»§ç»­"æŒ‰é’®æ¢å¤æ¸¸æˆ</text>
          
          <!-- æš‚åœæ—¶çš„æ“ä½œæŒ‰é’® -->
          <view class="pause-actions">
            <button class="pause-action-btn" style="background: linear-gradient(135deg, {{theme.colors.primary}}, {{theme.colors.primaryDark}}); box-shadow: 0 4rpx 12rpx {{theme.colors.shadow}};" bindtap="onNewGame">
              <text class="pause-action-icon">ğŸ”„</text>
              <text class="pause-action-label">æ–°æ¸¸æˆ</text>
            </button>
          </view>
        </view>
      </view>
    </view>
    
    <!-- åº•éƒ¨å·¥å…·æ  - è·Ÿéšæ£‹ç›˜ -->
    <view class="bottom-toolbar">
    <!-- åŠŸèƒ½æŒ‰é’®è¡Œ -->
    <view class="toolbar-actions">
      <button class="tool-btn" bindtap="onUndo" disabled="{{!canUndo}}">
        <text class="tool-icon" style="color: {{theme.colors.textDark}};">â†¶</text>
        <text class="tool-label" style="color: {{theme.colors.textDark}};">æ’¤é”€</text>
      </button>
      
      <button class="tool-btn" bindtap="onClearTap">
        <text class="tool-icon" style="color: {{theme.colors.textDark}};">ğŸ§¹</text>
        <text class="tool-label" style="color: {{theme.colors.textDark}};">æ¸…é™¤</text>
      </button>
      
      <button class="tool-btn {{isNoteMode ? 'active' : ''}}" style="{{isNoteMode ? 'background: ' + theme.colors.primaryLight + '; color: ' + theme.colors.textWhite + ';' : ''}}" bindtap="onToggleNoteMode">
        <text class="tool-icon" style="{{isNoteMode ? 'color: ' + theme.colors.textWhite + ';' : 'color: ' + theme.colors.textDark + ';'}}">âœ</text>
        <text class="tool-label" style="{{isNoteMode ? 'color: ' + theme.colors.textWhite + ';' : 'color: ' + theme.colors.textDark + ';'}}">{{isNoteMode ? 'å¡«æ•°' : 'ç¬”è®°'}}</text>
      </button>
      
      <button class="tool-btn" bindtap="onHint">
        <text class="tool-icon" style="color: {{theme.colors.textDark}};">ğŸ’¡</text>
        <text class="tool-label" style="color: {{theme.colors.textDark}};">æç¤º</text>
      </button>
      
      <button class="tool-btn {{isPaused ? 'active' : ''}}" style="{{isPaused ? 'background: ' + theme.colors.primaryLight + '; color: ' + theme.colors.textWhite + ';' : ''}}" bindtap="onPause">
        <text class="tool-icon" style="{{isPaused ? 'color: ' + theme.colors.textWhite + ';' : 'color: ' + theme.colors.textDark + ';'}}">{{isPaused ? 'â–¶' : 'â¸'}}</text>
        <text class="tool-label" style="{{isPaused ? 'color: ' + theme.colors.textWhite + ';' : 'color: ' + theme.colors.textDark + ';'}}">{{isPaused ? 'ç»§ç»­' : 'æš‚åœ'}}</text>
      </button>
    </view>
    
    <!-- æ•°å­—1-9æ¨ªå‘æ’åˆ— -->
    <view class="number-grid">
      <block wx:for="{{[1,2,3,4,5,6,7,8,9]}}" wx:key="*this">
        <view class="number-btn {{isNoteMode ? 'note-mode' : ''}}" style="border-color: {{theme.colors.border}}; {{isNoteMode ? 'background: ' + theme.colors.primaryLight + ';' : ''}}" data-num="{{item}}" bindtap="onNumberTap">
          <text class="number-main" style="color: {{isNoteMode ? theme.colors.textWhite : theme.colors.textDark}};">{{item}}</text>
          <text class="number-count" style="color: {{isNoteMode ? 'rgba(255, 255, 255, 0.8)' : theme.colors.textLight}};">{{numberCounts[item - 1]}}</text>
        </view>
      </block>
    </view>
    </view>
  </view>
</view>
